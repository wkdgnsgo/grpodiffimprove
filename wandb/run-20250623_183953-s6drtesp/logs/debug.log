2025-06-23 18:39:53,652 INFO    MainThread:21928 [wandb_setup.py:_flush():81] Current SDK version is 0.20.1
2025-06-23 18:39:53,652 INFO    MainThread:21928 [wandb_setup.py:_flush():81] Configure stats pid to 21928
2025-06-23 18:39:53,652 INFO    MainThread:21928 [wandb_setup.py:_flush():81] Loading settings from /Users/mark/.config/wandb/settings
2025-06-23 18:39:53,652 INFO    MainThread:21928 [wandb_setup.py:_flush():81] Loading settings from /Users/mark/Desktop/git/grpodiffimprove/wandb/settings
2025-06-23 18:39:53,652 INFO    MainThread:21928 [wandb_setup.py:_flush():81] Loading settings from environment variables
2025-06-23 18:39:53,652 INFO    MainThread:21928 [wandb_init.py:setup_run_log_directory():703] Logging user logs to /Users/mark/Desktop/git/grpodiffimprove/wandb/run-20250623_183953-s6drtesp/logs/debug.log
2025-06-23 18:39:53,652 INFO    MainThread:21928 [wandb_init.py:setup_run_log_directory():704] Logging internal logs to /Users/mark/Desktop/git/grpodiffimprove/wandb/run-20250623_183953-s6drtesp/logs/debug-internal.log
2025-06-23 18:39:53,652 INFO    MainThread:21928 [wandb_init.py:init():831] calling init triggers
2025-06-23 18:39:53,652 INFO    MainThread:21928 [wandb_init.py:init():836] wandb.init called with sweep_config: {}
config: {'_comment': 'VLM GRPO System Default Configuration', '_description': '이 파일은 VLM GRPO 시스템의 기본 설정을 포함합니다.', 'model_settings': {'_comment': '모델 관련 설정', 'vlm_model': 'Qwen/Qwen2.5-VL-7B-Instruct', 'sd_model': 'runwayml/stable-diffusion-v1-5', 'clip_model': 'openai/clip-vit-base-patch32'}, 'training_settings': {'_comment': '학습 관련 설정', 'learning_rate': 1e-05, 'group_size': 4, 'num_iterations': 50, 'grpo_epochs': 2, 'validation_interval': 1, 'checkpoint_interval': 10, 'grpo_parameters': {'gamma': 0.99, 'kl_beta': 0.01, 'clip_epsilon': 0.2, 'entropy_coeff': 0.01, 'max_grad_norm': 1.0}}, 'data_settings': {'_comment': '데이터 관련 설정', 'train_data_path': 'train_prompts.jsonl', 'val_data_path': 'val_prompts.jsonl', 'batch_shuffle': True, 'use_balanced_batches': False}, 'generation_settings': {'_comment': '생성 관련 설정', 'vlm_generation': {'max_new_tokens': 50, 'temperature': 0.8, 'top_p': 0.9}, 'sd_generation': {'height': 1024, 'width': 1024, 'num_inference_steps': 28, 'guidance_scale': 7.0}}, 'reward_settings': {'_comment': '보상 계산 설정', 'reward_weights': {'clip_similarity': 0.6, 'image_quality': 0.3, 'semantic_consistency': 0.1}, 'reward_scale': 1.0, 'reward_offset': 0.0, 'temperature': 1.0}, 'output_settings': {'_comment': '출력 관련 설정', 'output_dir': 'vlm_grpo_results', 'save_images': True, 'save_enhanced_prompts': True, 'log_level': 'INFO', 'save_frequency': 1, 'max_images_per_validation': 10}, 'wandb_settings': {'_comment': 'Wandb 실험 추적 설정', 'use_wandb': True, 'project': 'vlm-grpo-training', 'entity': None, 'tags': ['vlm', 'grpo', 'text-to-image'], 'notes': 'VLM GRPO training experiment'}, 'system_settings': {'_comment': '시스템 관련 설정', 'device': 'auto', 'mixed_precision': True, 'gradient_checkpointing': False, 'memory_efficient': True}, 'evaluation_settings': {'_comment': '평가 관련 설정', 'eval_batch_size': 10, 'save_eval_images': True, 'eval_categories': ['basic', 'complex', 'photography', 'creative'], 'eval_difficulties': ['easy', 'medium', 'hard']}, '_wandb': {}}
2025-06-23 18:39:53,652 INFO    MainThread:21928 [wandb_init.py:init():872] starting backend
2025-06-23 18:39:53,881 INFO    MainThread:21928 [wandb_init.py:init():875] sending inform_init request
2025-06-23 18:39:53,922 INFO    MainThread:21928 [wandb_init.py:init():883] backend started and connected
2025-06-23 18:39:53,926 INFO    MainThread:21928 [wandb_init.py:init():956] updated telemetry
2025-06-23 18:39:53,947 INFO    MainThread:21928 [wandb_init.py:init():980] communicating run to backend with 90.0 second timeout
2025-06-23 18:39:54,660 INFO    MainThread:21928 [wandb_init.py:init():1032] starting run threads in backend
2025-06-23 18:39:54,883 INFO    MainThread:21928 [wandb_run.py:_console_start():2453] atexit reg
2025-06-23 18:39:54,884 INFO    MainThread:21928 [wandb_run.py:_redirect():2301] redirect: wrap_raw
2025-06-23 18:39:54,884 INFO    MainThread:21928 [wandb_run.py:_redirect():2370] Wrapping output streams.
2025-06-23 18:39:54,884 INFO    MainThread:21928 [wandb_run.py:_redirect():2393] Redirects installed.
2025-06-23 18:39:54,886 INFO    MainThread:21928 [wandb_init.py:init():1078] run started, returning control to user process
