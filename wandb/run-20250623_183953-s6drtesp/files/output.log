2025-06-23 18:39:54,886 - integration.wandb_logger - INFO - 📈 Wandb initialized: https://wandb.ai/wkdgnsgo-korea-advanced-institute-of-science-and-technology/vlm-grpo-training/runs/s6drtesp
2025-06-23 18:39:54,886 - integration.main_trainer - INFO - ✅ All components initialized successfully
2025-06-23 18:39:54,886 - integration.main_trainer - INFO - 🚀 Starting VLM GRPO training...
2025-06-23 18:39:54,886 - integration.main_trainer - INFO - 🔄 Iteration 1/50
2025-06-23 18:39:55,364 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:39:55,366 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:39:58,243 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:39:58,244 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:39:58,677 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:39:58,678 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:39:58,725 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:39:58,726 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:39:58,814 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:39:58,815 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:39:58,817 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:39:58,818 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:39:58,818 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:39:58,818 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:39:58,818 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:39:58,818 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:39:58,824 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:39:58,824 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:39:58,824 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:39:58,824 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:39:58,824 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:39:58,824 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:39:58,824 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:39:58,824 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:39:58,825 - training.grpo_trainer - INFO - 🔄 GRPO update completed: loss=-0.0098, reward=0.7027
2025-06-23 18:39:58,825 - integration.main_trainer - INFO - 📊 Iteration 1 metrics:
2025-06-23 18:39:58,825 - integration.main_trainer - INFO -   - Policy Loss: 0.000000
2025-06-23 18:39:58,825 - integration.main_trainer - INFO -   - KL Divergence: 0.018731
2025-06-23 18:39:58,825 - integration.main_trainer - INFO -   - Entropy: 1.000000
2025-06-23 18:39:58,825 - integration.main_trainer - INFO -   - Average Reward: 0.7027
2025-06-23 18:39:58,825 - integration.main_trainer - INFO -   - Iteration Time: 3.94s
2025-06-23 18:39:58,825 - integration.main_trainer - INFO - 🔍 Running validation at iteration 1
2025-06-23 18:39:58,825 - evaluation.validator - INFO - 🔍 Evaluating batch of 2 items
2025-06-23 18:39:58,825 - evaluation.validator - INFO - 📁 Saving validation images to: vlm_grpo_results/validation_images_iter_1
2025-06-23 18:39:58,841 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:39:58,842 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:39:58,857 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:39:58,858 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:01,060 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:01,060 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:01,076 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:01,076 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:01,264 - evaluation.validator - INFO - ✅ Evaluation completed: 0.00% success rate
2025-06-23 18:40:01,265 - evaluation.validator - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:01,265 - integration.main_trainer - INFO - 📊 Validation Results (Iteration 1):
2025-06-23 18:40:01,265 - integration.main_trainer - INFO -   - timestamp: 1750671598.8257
2025-06-23 18:40:01,265 - integration.main_trainer - INFO -   - iteration: 1.0000
2025-06-23 18:40:01,265 - integration.main_trainer - INFO -   - total_samples: 2.0000
2025-06-23 18:40:01,265 - integration.main_trainer - INFO -   - success_rate: 0.0000
2025-06-23 18:40:01,265 - integration.main_trainer - INFO -   - avg_clip_score: 0.0000
2025-06-23 18:40:01,265 - integration.main_trainer - INFO -   - quality_score: 0.0000
2025-06-23 18:40:01,265 - integration.main_trainer - INFO -   - processing_time: 2.4392
2025-06-23 18:40:01,265 - integration.main_trainer - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:01,265 - integration.main_trainer - INFO -   📸 Image 1:
2025-06-23 18:40:01,265 - integration.main_trainer - INFO -     Original: 'dog...'
2025-06-23 18:40:01,265 - integration.main_trainer - INFO -     Enhanced: 'dog, loyal, friendly, well-lit, artistic, cinemati...'
2025-06-23 18:40:01,265 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_1/000_dog_enhanced.png
2025-06-23 18:40:01,265 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_1/000_dog_original.png
2025-06-23 18:40:01,265 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_1/000_dog_prompts.txt
2025-06-23 18:40:01,265 - integration.main_trainer - INFO -     CLIP Score: 0.109
2025-06-23 18:40:01,265 - integration.main_trainer - INFO -
2025-06-23 18:40:01,266 - integration.main_trainer - INFO -   📸 Image 2:
2025-06-23 18:40:01,266 - integration.main_trainer - INFO -     Original: 'city skyline...'
2025-06-23 18:40:01,266 - integration.main_trainer - INFO -     Enhanced: 'city skyline, urban, modern, masterpiece, detailed...'
2025-06-23 18:40:01,266 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_1/001_city skyline_enhanced.png
2025-06-23 18:40:01,266 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_1/001_city skyline_original.png
2025-06-23 18:40:01,266 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_1/001_city skyline_prompts.txt
2025-06-23 18:40:01,266 - integration.main_trainer - INFO -     CLIP Score: 0.112
2025-06-23 18:40:01,266 - integration.main_trainer - INFO -
2025-06-23 18:40:01,965 - numexpr.utils - INFO - Note: NumExpr detected 10 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-06-23 18:40:01,965 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-06-23 18:40:02,680 - integration.main_trainer - INFO - 📈 Uploaded 2 images to wandb
2025-06-23 18:40:02,682 - training.grpo_trainer - INFO - 💾 Checkpoint saved: vlm_grpo_results/best_model.pt
2025-06-23 18:40:02,682 - integration.main_trainer - INFO - 🏆 Best model saved: vlm_grpo_results/best_model.pt
2025-06-23 18:40:02,682 - integration.main_trainer - INFO - 🔄 Iteration 2/50
2025-06-23 18:40:02,704 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:02,705 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:03,168 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:03,168 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:03,216 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:03,217 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:03,263 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:03,263 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:03,294 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:03,295 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:03,295 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:03,295 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:03,295 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:03,295 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:03,295 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:03,295 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:03,296 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:03,296 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:03,296 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:03,296 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:03,296 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:03,296 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:03,296 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:03,296 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:03,297 - training.grpo_trainer - INFO - 🔄 GRPO update completed: loss=-0.0098, reward=0.7053
2025-06-23 18:40:03,297 - integration.main_trainer - INFO - 📊 Iteration 2 metrics:
2025-06-23 18:40:03,297 - integration.main_trainer - INFO -   - Policy Loss: 0.000000
2025-06-23 18:40:03,297 - integration.main_trainer - INFO -   - KL Divergence: 0.018731
2025-06-23 18:40:03,297 - integration.main_trainer - INFO -   - Entropy: 1.000000
2025-06-23 18:40:03,297 - integration.main_trainer - INFO -   - Average Reward: 0.7053
2025-06-23 18:40:03,297 - integration.main_trainer - INFO -   - Iteration Time: 0.61s
2025-06-23 18:40:03,297 - integration.main_trainer - INFO - 🔍 Running validation at iteration 2
2025-06-23 18:40:03,297 - evaluation.validator - INFO - 🔍 Evaluating batch of 2 items
2025-06-23 18:40:03,297 - evaluation.validator - INFO - 📁 Saving validation images to: vlm_grpo_results/validation_images_iter_2
2025-06-23 18:40:03,313 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:03,314 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:03,329 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:03,330 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:03,935 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:03,936 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:03,951 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:03,952 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:04,138 - evaluation.validator - INFO - ✅ Evaluation completed: 0.00% success rate
2025-06-23 18:40:04,138 - evaluation.validator - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:04,138 - integration.main_trainer - INFO - 📊 Validation Results (Iteration 2):
2025-06-23 18:40:04,138 - integration.main_trainer - INFO -   - timestamp: 1750671603.2979
2025-06-23 18:40:04,138 - integration.main_trainer - INFO -   - iteration: 2.0000
2025-06-23 18:40:04,138 - integration.main_trainer - INFO -   - total_samples: 2.0000
2025-06-23 18:40:04,138 - integration.main_trainer - INFO -   - success_rate: 0.0000
2025-06-23 18:40:04,138 - integration.main_trainer - INFO -   - avg_clip_score: 0.0000
2025-06-23 18:40:04,139 - integration.main_trainer - INFO -   - quality_score: 0.0000
2025-06-23 18:40:04,139 - integration.main_trainer - INFO -   - processing_time: 0.8403
2025-06-23 18:40:04,139 - integration.main_trainer - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:04,139 - integration.main_trainer - INFO -   📸 Image 1:
2025-06-23 18:40:04,139 - integration.main_trainer - INFO -     Original: 'dog...'
2025-06-23 18:40:04,139 - integration.main_trainer - INFO -     Enhanced: 'dog, loyal, friendly, masterpiece, high quality, v...'
2025-06-23 18:40:04,139 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_2/000_dog_enhanced.png
2025-06-23 18:40:04,139 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_2/000_dog_original.png
2025-06-23 18:40:04,139 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_2/000_dog_prompts.txt
2025-06-23 18:40:04,139 - integration.main_trainer - INFO -     CLIP Score: 0.109
2025-06-23 18:40:04,139 - integration.main_trainer - INFO -
2025-06-23 18:40:04,139 - integration.main_trainer - INFO -   📸 Image 2:
2025-06-23 18:40:04,139 - integration.main_trainer - INFO -     Original: 'city skyline...'
2025-06-23 18:40:04,139 - integration.main_trainer - INFO -     Enhanced: 'city skyline, urban, modern, artistic, detailed, d...'
2025-06-23 18:40:04,139 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_2/001_city skyline_enhanced.png
2025-06-23 18:40:04,139 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_2/001_city skyline_original.png
2025-06-23 18:40:04,139 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_2/001_city skyline_prompts.txt
2025-06-23 18:40:04,139 - integration.main_trainer - INFO -     CLIP Score: 0.112
2025-06-23 18:40:04,139 - integration.main_trainer - INFO -
2025-06-23 18:40:04,210 - integration.main_trainer - INFO - 📈 Uploaded 2 images to wandb
2025-06-23 18:40:04,211 - training.grpo_trainer - INFO - 💾 Checkpoint saved: vlm_grpo_results/best_model.pt
2025-06-23 18:40:04,211 - integration.main_trainer - INFO - 🏆 Best model saved: vlm_grpo_results/best_model.pt
2025-06-23 18:40:04,211 - integration.main_trainer - INFO - 🔄 Iteration 3/50
2025-06-23 18:40:04,227 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:04,227 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:04,645 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:04,646 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:04,693 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:04,693 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:04,740 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:04,740 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:04,771 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:04,771 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:04,772 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:04,772 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:04,772 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:04,772 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:04,772 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:04,772 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:04,773 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:04,773 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:04,773 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:04,773 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:04,773 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:04,773 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:04,773 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:04,773 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:04,773 - training.grpo_trainer - INFO - 🔄 GRPO update completed: loss=-0.0098, reward=0.7017
2025-06-23 18:40:04,774 - integration.main_trainer - INFO - 📊 Iteration 3 metrics:
2025-06-23 18:40:04,774 - integration.main_trainer - INFO -   - Policy Loss: 0.000000
2025-06-23 18:40:04,774 - integration.main_trainer - INFO -   - KL Divergence: 0.018731
2025-06-23 18:40:04,774 - integration.main_trainer - INFO -   - Entropy: 1.000000
2025-06-23 18:40:04,774 - integration.main_trainer - INFO -   - Average Reward: 0.7017
2025-06-23 18:40:04,774 - integration.main_trainer - INFO -   - Iteration Time: 0.56s
2025-06-23 18:40:04,774 - integration.main_trainer - INFO - 🔍 Running validation at iteration 3
2025-06-23 18:40:04,774 - evaluation.validator - INFO - 🔍 Evaluating batch of 2 items
2025-06-23 18:40:04,774 - evaluation.validator - INFO - 📁 Saving validation images to: vlm_grpo_results/validation_images_iter_3
2025-06-23 18:40:04,825 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:04,825 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:04,841 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:04,842 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:05,046 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:05,046 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:05,062 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:05,063 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:05,247 - evaluation.validator - INFO - ✅ Evaluation completed: 0.00% success rate
2025-06-23 18:40:05,247 - evaluation.validator - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:05,247 - integration.main_trainer - INFO - 📊 Validation Results (Iteration 3):
2025-06-23 18:40:05,247 - integration.main_trainer - INFO -   - timestamp: 1750671604.7747
2025-06-23 18:40:05,247 - integration.main_trainer - INFO -   - iteration: 3.0000
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -   - total_samples: 2.0000
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -   - success_rate: 0.0000
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -   - avg_clip_score: 0.0000
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -   - quality_score: 0.0000
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -   - processing_time: 0.4728
2025-06-23 18:40:05,248 - integration.main_trainer - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -   📸 Image 1:
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -     Original: 'dog...'
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -     Enhanced: 'dog, loyal, friendly, masterpiece, high quality, p...'
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_3/000_dog_enhanced.png
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_3/000_dog_original.png
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_3/000_dog_prompts.txt
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -     CLIP Score: 0.108
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -   📸 Image 2:
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -     Original: 'city skyline...'
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -     Enhanced: 'city skyline, urban, modern, high quality, artisti...'
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_3/001_city skyline_enhanced.png
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_3/001_city skyline_original.png
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_3/001_city skyline_prompts.txt
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -     CLIP Score: 0.114
2025-06-23 18:40:05,248 - integration.main_trainer - INFO -
2025-06-23 18:40:05,320 - integration.main_trainer - INFO - 📈 Uploaded 2 images to wandb
2025-06-23 18:40:05,320 - integration.main_trainer - INFO - 🔄 Iteration 4/50
2025-06-23 18:40:05,336 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:05,337 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:05,383 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:05,384 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:05,430 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:05,431 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:05,476 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:05,476 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:05,506 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:05,507 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:05,507 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:05,507 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:05,507 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:05,507 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:05,507 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:05,507 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:05,508 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:05,508 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:05,508 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:05,508 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:05,508 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:05,508 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:05,508 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:05,508 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:05,509 - training.grpo_trainer - INFO - 🔄 GRPO update completed: loss=-0.0098, reward=0.7001
2025-06-23 18:40:05,509 - integration.main_trainer - INFO - 📊 Iteration 4 metrics:
2025-06-23 18:40:05,509 - integration.main_trainer - INFO -   - Policy Loss: 0.000000
2025-06-23 18:40:05,509 - integration.main_trainer - INFO -   - KL Divergence: 0.018731
2025-06-23 18:40:05,509 - integration.main_trainer - INFO -   - Entropy: 1.000000
2025-06-23 18:40:05,509 - integration.main_trainer - INFO -   - Average Reward: 0.7001
2025-06-23 18:40:05,509 - integration.main_trainer - INFO -   - Iteration Time: 0.19s
2025-06-23 18:40:05,509 - integration.main_trainer - INFO - 🔍 Running validation at iteration 4
2025-06-23 18:40:05,509 - evaluation.validator - INFO - 🔍 Evaluating batch of 2 items
2025-06-23 18:40:05,509 - evaluation.validator - INFO - 📁 Saving validation images to: vlm_grpo_results/validation_images_iter_4
2025-06-23 18:40:05,526 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:05,526 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:05,541 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:05,542 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:05,744 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:05,744 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:05,760 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:05,761 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:05,942 - evaluation.validator - INFO - ✅ Evaluation completed: 0.00% success rate
2025-06-23 18:40:05,942 - evaluation.validator - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:05,942 - integration.main_trainer - INFO - 📊 Validation Results (Iteration 4):
2025-06-23 18:40:05,942 - integration.main_trainer - INFO -   - timestamp: 1750671605.5100
2025-06-23 18:40:05,942 - integration.main_trainer - INFO -   - iteration: 4.0000
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -   - total_samples: 2.0000
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -   - success_rate: 0.0000
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -   - avg_clip_score: 0.0000
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -   - quality_score: 0.0000
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -   - processing_time: 0.4326
2025-06-23 18:40:05,943 - integration.main_trainer - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -   📸 Image 1:
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -     Original: 'dog...'
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -     Enhanced: 'dog, loyal, friendly, detailed, 8k resolution, pho...'
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_4/000_dog_enhanced.png
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_4/000_dog_original.png
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_4/000_dog_prompts.txt
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -     CLIP Score: 0.122
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -   📸 Image 2:
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -     Original: 'city skyline...'
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -     Enhanced: 'city skyline, urban, modern, detailed, 8k resoluti...'
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_4/001_city skyline_enhanced.png
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_4/001_city skyline_original.png
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_4/001_city skyline_prompts.txt
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -     CLIP Score: 0.120
2025-06-23 18:40:05,943 - integration.main_trainer - INFO -
2025-06-23 18:40:06,015 - integration.main_trainer - INFO - 📈 Uploaded 2 images to wandb
2025-06-23 18:40:06,015 - integration.main_trainer - INFO - 🔄 Iteration 5/50
2025-06-23 18:40:06,031 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:06,032 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:06,078 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:06,079 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:06,123 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:06,124 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:06,168 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:06,169 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:06,199 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:06,199 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:06,200 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:06,200 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:06,200 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:06,200 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:06,200 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:06,200 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:06,200 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:06,200 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:06,201 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:06,201 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:06,201 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:06,201 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:06,201 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:06,201 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:06,201 - training.grpo_trainer - INFO - 🔄 GRPO update completed: loss=-0.0098, reward=0.7131
2025-06-23 18:40:06,201 - integration.main_trainer - INFO - 📊 Iteration 5 metrics:
2025-06-23 18:40:06,201 - integration.main_trainer - INFO -   - Policy Loss: 0.000000
2025-06-23 18:40:06,201 - integration.main_trainer - INFO -   - KL Divergence: 0.018731
2025-06-23 18:40:06,201 - integration.main_trainer - INFO -   - Entropy: 1.000000
2025-06-23 18:40:06,201 - integration.main_trainer - INFO -   - Average Reward: 0.7131
2025-06-23 18:40:06,201 - integration.main_trainer - INFO -   - Iteration Time: 0.19s
2025-06-23 18:40:06,202 - integration.main_trainer - INFO - 🔍 Running validation at iteration 5
2025-06-23 18:40:06,202 - evaluation.validator - INFO - 🔍 Evaluating batch of 2 items
2025-06-23 18:40:06,202 - evaluation.validator - INFO - 📁 Saving validation images to: vlm_grpo_results/validation_images_iter_5
2025-06-23 18:40:06,218 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:06,218 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:06,234 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:06,234 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:06,438 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:06,439 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:06,454 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:06,455 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:06,645 - evaluation.validator - INFO - ✅ Evaluation completed: 0.00% success rate
2025-06-23 18:40:06,645 - evaluation.validator - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:06,645 - integration.main_trainer - INFO - 📊 Validation Results (Iteration 5):
2025-06-23 18:40:06,645 - integration.main_trainer - INFO -   - timestamp: 1750671606.2023
2025-06-23 18:40:06,645 - integration.main_trainer - INFO -   - iteration: 5.0000
2025-06-23 18:40:06,645 - integration.main_trainer - INFO -   - total_samples: 2.0000
2025-06-23 18:40:06,645 - integration.main_trainer - INFO -   - success_rate: 0.0000
2025-06-23 18:40:06,645 - integration.main_trainer - INFO -   - avg_clip_score: 0.0000
2025-06-23 18:40:06,645 - integration.main_trainer - INFO -   - quality_score: 0.0000
2025-06-23 18:40:06,645 - integration.main_trainer - INFO -   - processing_time: 0.4430
2025-06-23 18:40:06,645 - integration.main_trainer - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:06,645 - integration.main_trainer - INFO -   📸 Image 1:
2025-06-23 18:40:06,645 - integration.main_trainer - INFO -     Original: 'dog...'
2025-06-23 18:40:06,645 - integration.main_trainer - INFO -     Enhanced: 'dog, loyal, friendly, well-lit, detailed, perfect ...'
2025-06-23 18:40:06,645 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_5/000_dog_enhanced.png
2025-06-23 18:40:06,646 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_5/000_dog_original.png
2025-06-23 18:40:06,646 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_5/000_dog_prompts.txt
2025-06-23 18:40:06,646 - integration.main_trainer - INFO -     CLIP Score: 0.108
2025-06-23 18:40:06,646 - integration.main_trainer - INFO -
2025-06-23 18:40:06,646 - integration.main_trainer - INFO -   📸 Image 2:
2025-06-23 18:40:06,646 - integration.main_trainer - INFO -     Original: 'city skyline...'
2025-06-23 18:40:06,646 - integration.main_trainer - INFO -     Enhanced: 'city skyline, urban, modern, masterpiece, artistic...'
2025-06-23 18:40:06,646 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_5/001_city skyline_enhanced.png
2025-06-23 18:40:06,646 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_5/001_city skyline_original.png
2025-06-23 18:40:06,646 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_5/001_city skyline_prompts.txt
2025-06-23 18:40:06,646 - integration.main_trainer - INFO -     CLIP Score: 0.108
2025-06-23 18:40:06,646 - integration.main_trainer - INFO -
2025-06-23 18:40:06,716 - integration.main_trainer - INFO - 📈 Uploaded 2 images to wandb
2025-06-23 18:40:06,717 - training.grpo_trainer - INFO - 💾 Checkpoint saved: vlm_grpo_results/best_model.pt
2025-06-23 18:40:06,717 - integration.main_trainer - INFO - 🏆 Best model saved: vlm_grpo_results/best_model.pt
2025-06-23 18:40:06,717 - integration.main_trainer - INFO - 🔄 Iteration 6/50
2025-06-23 18:40:06,733 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:06,734 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:06,782 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:06,782 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:06,876 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:06,877 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:06,923 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:06,924 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:07,334 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:07,334 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:07,334 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:07,334 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:07,334 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:07,335 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:07,335 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:07,335 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:07,335 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:07,335 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:07,335 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:07,335 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:07,335 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:07,335 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:07,336 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:07,336 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:07,336 - training.grpo_trainer - INFO - 🔄 GRPO update completed: loss=-0.0098, reward=0.7066
2025-06-23 18:40:07,336 - integration.main_trainer - INFO - 📊 Iteration 6 metrics:
2025-06-23 18:40:07,336 - integration.main_trainer - INFO -   - Policy Loss: 0.000000
2025-06-23 18:40:07,336 - integration.main_trainer - INFO -   - KL Divergence: 0.018731
2025-06-23 18:40:07,336 - integration.main_trainer - INFO -   - Entropy: 1.000000
2025-06-23 18:40:07,336 - integration.main_trainer - INFO -   - Average Reward: 0.7066
2025-06-23 18:40:07,336 - integration.main_trainer - INFO -   - Iteration Time: 0.62s
2025-06-23 18:40:07,336 - integration.main_trainer - INFO - 🔍 Running validation at iteration 6
2025-06-23 18:40:07,336 - evaluation.validator - INFO - 🔍 Evaluating batch of 2 items
2025-06-23 18:40:07,336 - evaluation.validator - INFO - 📁 Saving validation images to: vlm_grpo_results/validation_images_iter_6
2025-06-23 18:40:07,353 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:07,353 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:07,368 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:07,369 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:07,573 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:07,573 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:07,589 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:07,590 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:07,776 - evaluation.validator - INFO - ✅ Evaluation completed: 0.00% success rate
2025-06-23 18:40:07,776 - evaluation.validator - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:07,776 - integration.main_trainer - INFO - 📊 Validation Results (Iteration 6):
2025-06-23 18:40:07,776 - integration.main_trainer - INFO -   - timestamp: 1750671607.3369
2025-06-23 18:40:07,776 - integration.main_trainer - INFO -   - iteration: 6.0000
2025-06-23 18:40:07,776 - integration.main_trainer - INFO -   - total_samples: 2.0000
2025-06-23 18:40:07,776 - integration.main_trainer - INFO -   - success_rate: 0.0000
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -   - avg_clip_score: 0.0000
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -   - quality_score: 0.0000
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -   - processing_time: 0.4394
2025-06-23 18:40:07,777 - integration.main_trainer - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -   📸 Image 1:
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -     Original: 'dog...'
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -     Enhanced: 'dog, loyal, friendly, well-lit, masterpiece, vivid...'
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_6/000_dog_enhanced.png
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_6/000_dog_original.png
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_6/000_dog_prompts.txt
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -     CLIP Score: 0.109
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -   📸 Image 2:
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -     Original: 'city skyline...'
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -     Enhanced: 'city skyline, urban, modern, artistic, well-lit, v...'
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_6/001_city skyline_enhanced.png
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_6/001_city skyline_original.png
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_6/001_city skyline_prompts.txt
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -     CLIP Score: 0.109
2025-06-23 18:40:07,777 - integration.main_trainer - INFO -
2025-06-23 18:40:07,847 - integration.main_trainer - INFO - 📈 Uploaded 2 images to wandb
2025-06-23 18:40:07,847 - integration.main_trainer - INFO - 🔄 Iteration 7/50
2025-06-23 18:40:07,863 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:07,864 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:07,910 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:07,911 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:07,957 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:07,957 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:08,386 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:08,386 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:08,417 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:08,418 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:08,418 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:08,418 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:08,418 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:08,418 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:08,418 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:08,418 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:08,419 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:08,419 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:08,419 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:08,419 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:08,419 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:08,419 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:08,419 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:08,419 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:08,420 - training.grpo_trainer - INFO - 🔄 GRPO update completed: loss=-0.0098, reward=0.7015
2025-06-23 18:40:08,420 - integration.main_trainer - INFO - 📊 Iteration 7 metrics:
2025-06-23 18:40:08,420 - integration.main_trainer - INFO -   - Policy Loss: 0.000000
2025-06-23 18:40:08,420 - integration.main_trainer - INFO -   - KL Divergence: 0.018731
2025-06-23 18:40:08,420 - integration.main_trainer - INFO -   - Entropy: 1.000000
2025-06-23 18:40:08,420 - integration.main_trainer - INFO -   - Average Reward: 0.7015
2025-06-23 18:40:08,420 - integration.main_trainer - INFO -   - Iteration Time: 0.57s
2025-06-23 18:40:08,420 - integration.main_trainer - INFO - 🔍 Running validation at iteration 7
2025-06-23 18:40:08,420 - evaluation.validator - INFO - 🔍 Evaluating batch of 2 items
2025-06-23 18:40:08,420 - evaluation.validator - INFO - 📁 Saving validation images to: vlm_grpo_results/validation_images_iter_7
2025-06-23 18:40:08,436 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:08,436 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:08,452 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:08,453 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:08,656 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:08,657 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:08,672 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:08,673 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:08,861 - evaluation.validator - INFO - ✅ Evaluation completed: 0.00% success rate
2025-06-23 18:40:08,861 - evaluation.validator - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:08,861 - integration.main_trainer - INFO - 📊 Validation Results (Iteration 7):
2025-06-23 18:40:08,861 - integration.main_trainer - INFO -   - timestamp: 1750671608.4207
2025-06-23 18:40:08,861 - integration.main_trainer - INFO -   - iteration: 7.0000
2025-06-23 18:40:08,861 - integration.main_trainer - INFO -   - total_samples: 2.0000
2025-06-23 18:40:08,861 - integration.main_trainer - INFO -   - success_rate: 0.0000
2025-06-23 18:40:08,861 - integration.main_trainer - INFO -   - avg_clip_score: 0.0000
2025-06-23 18:40:08,861 - integration.main_trainer - INFO -   - quality_score: 0.0000
2025-06-23 18:40:08,861 - integration.main_trainer - INFO -   - processing_time: 0.4404
2025-06-23 18:40:08,861 - integration.main_trainer - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:08,861 - integration.main_trainer - INFO -   📸 Image 1:
2025-06-23 18:40:08,861 - integration.main_trainer - INFO -     Original: 'dog...'
2025-06-23 18:40:08,862 - integration.main_trainer - INFO -     Enhanced: 'dog, loyal, friendly, sharp focus, high quality, p...'
2025-06-23 18:40:08,862 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_7/000_dog_enhanced.png
2025-06-23 18:40:08,862 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_7/000_dog_original.png
2025-06-23 18:40:08,862 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_7/000_dog_prompts.txt
2025-06-23 18:40:08,862 - integration.main_trainer - INFO -     CLIP Score: 0.106
2025-06-23 18:40:08,862 - integration.main_trainer - INFO -
2025-06-23 18:40:08,862 - integration.main_trainer - INFO -   📸 Image 2:
2025-06-23 18:40:08,862 - integration.main_trainer - INFO -     Original: 'city skyline...'
2025-06-23 18:40:08,862 - integration.main_trainer - INFO -     Enhanced: 'city skyline, urban, modern, professional, sharp f...'
2025-06-23 18:40:08,862 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_7/001_city skyline_enhanced.png
2025-06-23 18:40:08,862 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_7/001_city skyline_original.png
2025-06-23 18:40:08,862 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_7/001_city skyline_prompts.txt
2025-06-23 18:40:08,862 - integration.main_trainer - INFO -     CLIP Score: 0.115
2025-06-23 18:40:08,862 - integration.main_trainer - INFO -
2025-06-23 18:40:08,933 - integration.main_trainer - INFO - 📈 Uploaded 2 images to wandb
2025-06-23 18:40:08,933 - integration.main_trainer - INFO - 🔄 Iteration 8/50
2025-06-23 18:40:08,949 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:08,949 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:08,997 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:08,997 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:09,042 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:09,043 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:09,089 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:09,089 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:09,119 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:09,120 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:09,120 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:09,120 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:09,120 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:09,120 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:09,120 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:09,120 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:09,121 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:09,121 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:09,121 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:09,121 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:09,121 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:09,121 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:09,121 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:09,121 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:09,122 - training.grpo_trainer - INFO - 🔄 GRPO update completed: loss=-0.0098, reward=0.7019
2025-06-23 18:40:09,122 - integration.main_trainer - INFO - 📊 Iteration 8 metrics:
2025-06-23 18:40:09,122 - integration.main_trainer - INFO -   - Policy Loss: 0.000000
2025-06-23 18:40:09,122 - integration.main_trainer - INFO -   - KL Divergence: 0.018731
2025-06-23 18:40:09,122 - integration.main_trainer - INFO -   - Entropy: 1.000000
2025-06-23 18:40:09,122 - integration.main_trainer - INFO -   - Average Reward: 0.7019
2025-06-23 18:40:09,122 - integration.main_trainer - INFO -   - Iteration Time: 0.19s
2025-06-23 18:40:09,122 - integration.main_trainer - INFO - 🔍 Running validation at iteration 8
2025-06-23 18:40:09,122 - evaluation.validator - INFO - 🔍 Evaluating batch of 2 items
2025-06-23 18:40:09,122 - evaluation.validator - INFO - 📁 Saving validation images to: vlm_grpo_results/validation_images_iter_8
2025-06-23 18:40:09,138 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:09,138 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:09,154 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:09,154 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:09,355 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:09,355 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:09,371 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:09,372 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:09,558 - evaluation.validator - INFO - ✅ Evaluation completed: 0.00% success rate
2025-06-23 18:40:09,558 - evaluation.validator - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:09,558 - integration.main_trainer - INFO - 📊 Validation Results (Iteration 8):
2025-06-23 18:40:09,558 - integration.main_trainer - INFO -   - timestamp: 1750671609.1228
2025-06-23 18:40:09,558 - integration.main_trainer - INFO -   - iteration: 8.0000
2025-06-23 18:40:09,558 - integration.main_trainer - INFO -   - total_samples: 2.0000
2025-06-23 18:40:09,558 - integration.main_trainer - INFO -   - success_rate: 0.0000
2025-06-23 18:40:09,558 - integration.main_trainer - INFO -   - avg_clip_score: 0.0000
2025-06-23 18:40:09,558 - integration.main_trainer - INFO -   - quality_score: 0.0000
2025-06-23 18:40:09,558 - integration.main_trainer - INFO -   - processing_time: 0.4353
2025-06-23 18:40:09,558 - integration.main_trainer - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:09,558 - integration.main_trainer - INFO -   📸 Image 1:
2025-06-23 18:40:09,558 - integration.main_trainer - INFO -     Original: 'dog...'
2025-06-23 18:40:09,558 - integration.main_trainer - INFO -     Enhanced: 'dog, loyal, friendly, 8k resolution, detailed, pho...'
2025-06-23 18:40:09,558 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_8/000_dog_enhanced.png
2025-06-23 18:40:09,558 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_8/000_dog_original.png
2025-06-23 18:40:09,558 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_8/000_dog_prompts.txt
2025-06-23 18:40:09,559 - integration.main_trainer - INFO -     CLIP Score: 0.123
2025-06-23 18:40:09,559 - integration.main_trainer - INFO -
2025-06-23 18:40:09,559 - integration.main_trainer - INFO -   📸 Image 2:
2025-06-23 18:40:09,559 - integration.main_trainer - INFO -     Original: 'city skyline...'
2025-06-23 18:40:09,559 - integration.main_trainer - INFO -     Enhanced: 'city skyline, urban, modern, artistic, sharp focus...'
2025-06-23 18:40:09,559 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_8/001_city skyline_enhanced.png
2025-06-23 18:40:09,559 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_8/001_city skyline_original.png
2025-06-23 18:40:09,559 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_8/001_city skyline_prompts.txt
2025-06-23 18:40:09,559 - integration.main_trainer - INFO -     CLIP Score: 0.118
2025-06-23 18:40:09,559 - integration.main_trainer - INFO -
2025-06-23 18:40:09,629 - integration.main_trainer - INFO - 📈 Uploaded 2 images to wandb
2025-06-23 18:40:09,630 - integration.main_trainer - INFO - 🔄 Iteration 9/50
2025-06-23 18:40:09,645 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:09,646 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:09,692 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:09,693 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:09,740 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:09,740 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:09,786 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:09,787 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:09,818 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:09,818 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:09,818 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:09,819 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:09,819 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:09,819 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:09,819 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:09,819 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:09,819 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:09,819 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:09,819 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:09,820 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:09,820 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:09,820 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:09,820 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:09,820 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:09,820 - training.grpo_trainer - INFO - 🔄 GRPO update completed: loss=-0.0098, reward=0.7058
2025-06-23 18:40:09,820 - integration.main_trainer - INFO - 📊 Iteration 9 metrics:
2025-06-23 18:40:09,820 - integration.main_trainer - INFO -   - Policy Loss: 0.000000
2025-06-23 18:40:09,820 - integration.main_trainer - INFO -   - KL Divergence: 0.018731
2025-06-23 18:40:09,820 - integration.main_trainer - INFO -   - Entropy: 1.000000
2025-06-23 18:40:09,820 - integration.main_trainer - INFO -   - Average Reward: 0.7058
2025-06-23 18:40:09,820 - integration.main_trainer - INFO -   - Iteration Time: 0.19s
2025-06-23 18:40:09,820 - integration.main_trainer - INFO - 🔍 Running validation at iteration 9
2025-06-23 18:40:09,820 - evaluation.validator - INFO - 🔍 Evaluating batch of 2 items
2025-06-23 18:40:09,821 - evaluation.validator - INFO - 📁 Saving validation images to: vlm_grpo_results/validation_images_iter_9
2025-06-23 18:40:09,837 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:09,837 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:09,889 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:09,891 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:10,095 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:10,096 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:10,112 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:10,113 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:10,299 - evaluation.validator - INFO - ✅ Evaluation completed: 0.00% success rate
2025-06-23 18:40:10,300 - evaluation.validator - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:10,300 - integration.main_trainer - INFO - 📊 Validation Results (Iteration 9):
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -   - timestamp: 1750671609.8211
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -   - iteration: 9.0000
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -   - total_samples: 2.0000
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -   - success_rate: 0.0000
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -   - avg_clip_score: 0.0000
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -   - quality_score: 0.0000
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -   - processing_time: 0.4788
2025-06-23 18:40:10,300 - integration.main_trainer - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -   📸 Image 1:
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -     Original: 'dog...'
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -     Enhanced: 'dog, loyal, friendly, artistic, sharp focus, photo...'
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_9/000_dog_enhanced.png
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_9/000_dog_original.png
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_9/000_dog_prompts.txt
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -     CLIP Score: 0.117
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -   📸 Image 2:
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -     Original: 'city skyline...'
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -     Enhanced: 'city skyline, urban, modern, sharp focus, detailed...'
2025-06-23 18:40:10,300 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_9/001_city skyline_enhanced.png
2025-06-23 18:40:10,301 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_9/001_city skyline_original.png
2025-06-23 18:40:10,301 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_9/001_city skyline_prompts.txt
2025-06-23 18:40:10,301 - integration.main_trainer - INFO -     CLIP Score: 0.115
2025-06-23 18:40:10,301 - integration.main_trainer - INFO -
2025-06-23 18:40:10,371 - integration.main_trainer - INFO - 📈 Uploaded 2 images to wandb
2025-06-23 18:40:10,371 - integration.main_trainer - INFO - 🔄 Iteration 10/50
2025-06-23 18:40:10,387 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:10,388 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:10,434 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:10,434 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:10,480 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:10,481 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:10,527 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:10,528 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:10,557 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:10,558 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:10,558 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:10,558 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:10,558 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:10,558 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:10,558 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:10,558 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:10,559 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:10,559 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:10,559 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:10,559 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:10,559 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:10,559 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:10,559 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:10,559 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:10,559 - training.grpo_trainer - INFO - 🔄 GRPO update completed: loss=-0.0098, reward=0.7015
2025-06-23 18:40:10,559 - integration.main_trainer - INFO - 📊 Iteration 10 metrics:
2025-06-23 18:40:10,559 - integration.main_trainer - INFO -   - Policy Loss: 0.000000
2025-06-23 18:40:10,559 - integration.main_trainer - INFO -   - KL Divergence: 0.018731
2025-06-23 18:40:10,559 - integration.main_trainer - INFO -   - Entropy: 1.000000
2025-06-23 18:40:10,559 - integration.main_trainer - INFO -   - Average Reward: 0.7015
2025-06-23 18:40:10,560 - integration.main_trainer - INFO -   - Iteration Time: 0.19s
2025-06-23 18:40:10,560 - integration.main_trainer - INFO - 🔍 Running validation at iteration 10
2025-06-23 18:40:10,560 - evaluation.validator - INFO - 🔍 Evaluating batch of 2 items
2025-06-23 18:40:10,560 - evaluation.validator - INFO - 📁 Saving validation images to: vlm_grpo_results/validation_images_iter_10
2025-06-23 18:40:10,576 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:10,576 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:10,592 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:10,592 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:10,798 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:10,799 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:10,815 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:10,816 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:11,053 - evaluation.validator - INFO - ✅ Evaluation completed: 0.00% success rate
2025-06-23 18:40:11,053 - evaluation.validator - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:11,053 - integration.main_trainer - INFO - 📊 Validation Results (Iteration 10):
2025-06-23 18:40:11,053 - integration.main_trainer - INFO -   - timestamp: 1750671610.5604
2025-06-23 18:40:11,053 - integration.main_trainer - INFO -   - iteration: 10.0000
2025-06-23 18:40:11,053 - integration.main_trainer - INFO -   - total_samples: 2.0000
2025-06-23 18:40:11,053 - integration.main_trainer - INFO -   - success_rate: 0.0000
2025-06-23 18:40:11,053 - integration.main_trainer - INFO -   - avg_clip_score: 0.0000
2025-06-23 18:40:11,053 - integration.main_trainer - INFO -   - quality_score: 0.0000
2025-06-23 18:40:11,053 - integration.main_trainer - INFO -   - processing_time: 0.4930
2025-06-23 18:40:11,053 - integration.main_trainer - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:11,053 - integration.main_trainer - INFO -   📸 Image 1:
2025-06-23 18:40:11,054 - integration.main_trainer - INFO -     Original: 'dog...'
2025-06-23 18:40:11,054 - integration.main_trainer - INFO -     Enhanced: 'dog, loyal, friendly, well-lit, high quality, dept...'
2025-06-23 18:40:11,054 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_10/000_dog_enhanced.png
2025-06-23 18:40:11,054 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_10/000_dog_original.png
2025-06-23 18:40:11,054 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_10/000_dog_prompts.txt
2025-06-23 18:40:11,054 - integration.main_trainer - INFO -     CLIP Score: 0.102
2025-06-23 18:40:11,054 - integration.main_trainer - INFO -
2025-06-23 18:40:11,054 - integration.main_trainer - INFO -   📸 Image 2:
2025-06-23 18:40:11,054 - integration.main_trainer - INFO -     Original: 'city skyline...'
2025-06-23 18:40:11,054 - integration.main_trainer - INFO -     Enhanced: 'city skyline, urban, modern, detailed, sharp focus...'
2025-06-23 18:40:11,054 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_10/001_city skyline_enhanced.png
2025-06-23 18:40:11,054 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_10/001_city skyline_original.png
2025-06-23 18:40:11,054 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_10/001_city skyline_prompts.txt
2025-06-23 18:40:11,054 - integration.main_trainer - INFO -     CLIP Score: 0.117
2025-06-23 18:40:11,054 - integration.main_trainer - INFO -
2025-06-23 18:40:11,125 - integration.main_trainer - INFO - 📈 Uploaded 2 images to wandb
2025-06-23 18:40:11,126 - training.grpo_trainer - INFO - 💾 Checkpoint saved: vlm_grpo_results/checkpoint_iter_10.pt
2025-06-23 18:40:11,126 - integration.main_trainer - INFO - 💾 Checkpoint saved: vlm_grpo_results/checkpoint_iter_10.pt
2025-06-23 18:40:11,126 - integration.main_trainer - INFO - 🔄 Iteration 11/50
2025-06-23 18:40:11,142 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:11,142 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:11,190 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:11,190 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:11,236 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:11,237 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:11,282 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:11,283 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:11,313 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:11,313 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:11,313 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:11,313 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:11,313 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:11,313 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:11,314 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:11,314 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:11,314 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:11,314 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:11,314 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:11,314 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:11,314 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:11,314 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:11,314 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:11,314 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:11,315 - training.grpo_trainer - INFO - 🔄 GRPO update completed: loss=-0.0098, reward=0.7032
2025-06-23 18:40:11,315 - integration.main_trainer - INFO - 📊 Iteration 11 metrics:
2025-06-23 18:40:11,315 - integration.main_trainer - INFO -   - Policy Loss: 0.000000
2025-06-23 18:40:11,315 - integration.main_trainer - INFO -   - KL Divergence: 0.018731
2025-06-23 18:40:11,315 - integration.main_trainer - INFO -   - Entropy: 1.000000
2025-06-23 18:40:11,315 - integration.main_trainer - INFO -   - Average Reward: 0.7032
2025-06-23 18:40:11,315 - integration.main_trainer - INFO -   - Iteration Time: 0.19s
2025-06-23 18:40:11,315 - integration.main_trainer - INFO - 🔍 Running validation at iteration 11
2025-06-23 18:40:11,315 - evaluation.validator - INFO - 🔍 Evaluating batch of 2 items
2025-06-23 18:40:11,315 - evaluation.validator - INFO - 📁 Saving validation images to: vlm_grpo_results/validation_images_iter_11
2025-06-23 18:40:11,331 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:11,331 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:11,348 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:11,348 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:11,551 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:11,551 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:11,567 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:11,568 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:11,752 - evaluation.validator - INFO - ✅ Evaluation completed: 0.00% success rate
2025-06-23 18:40:11,752 - evaluation.validator - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:11,752 - integration.main_trainer - INFO - 📊 Validation Results (Iteration 11):
2025-06-23 18:40:11,753 - integration.main_trainer - INFO -   - timestamp: 1750671611.3159
2025-06-23 18:40:11,753 - integration.main_trainer - INFO -   - iteration: 11.0000
2025-06-23 18:40:11,753 - integration.main_trainer - INFO -   - total_samples: 2.0000
2025-06-23 18:40:11,753 - integration.main_trainer - INFO -   - success_rate: 0.0000
2025-06-23 18:40:11,753 - integration.main_trainer - INFO -   - avg_clip_score: 0.0000
2025-06-23 18:40:11,753 - integration.main_trainer - INFO -   - quality_score: 0.0000
2025-06-23 18:40:11,753 - integration.main_trainer - INFO -   - processing_time: 0.4368
2025-06-23 18:40:11,753 - integration.main_trainer - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:11,753 - integration.main_trainer - INFO -   📸 Image 1:
2025-06-23 18:40:11,753 - integration.main_trainer - INFO -     Original: 'dog...'
2025-06-23 18:40:11,753 - integration.main_trainer - INFO -     Enhanced: 'dog, loyal, friendly, professional, 8k resolution,...'
2025-06-23 18:40:11,753 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_11/000_dog_enhanced.png
2025-06-23 18:40:11,754 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_11/000_dog_original.png
2025-06-23 18:40:11,754 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_11/000_dog_prompts.txt
2025-06-23 18:40:11,754 - integration.main_trainer - INFO -     CLIP Score: 0.123
2025-06-23 18:40:11,754 - integration.main_trainer - INFO -
2025-06-23 18:40:11,754 - integration.main_trainer - INFO -   📸 Image 2:
2025-06-23 18:40:11,754 - integration.main_trainer - INFO -     Original: 'city skyline...'
2025-06-23 18:40:11,754 - integration.main_trainer - INFO -     Enhanced: 'city skyline, urban, modern, professional, high qu...'
2025-06-23 18:40:11,754 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_11/001_city skyline_enhanced.png
2025-06-23 18:40:11,754 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_11/001_city skyline_original.png
2025-06-23 18:40:11,754 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_11/001_city skyline_prompts.txt
2025-06-23 18:40:11,754 - integration.main_trainer - INFO -     CLIP Score: 0.122
2025-06-23 18:40:11,754 - integration.main_trainer - INFO -
2025-06-23 18:40:11,825 - integration.main_trainer - INFO - 📈 Uploaded 2 images to wandb
2025-06-23 18:40:11,826 - integration.main_trainer - INFO - 🔄 Iteration 12/50
2025-06-23 18:40:11,842 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:11,843 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:11,890 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:11,891 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:11,942 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:11,943 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:11,990 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:11,991 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:12,021 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:12,021 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:12,022 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:12,022 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:12,022 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:12,022 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:12,022 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:12,022 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:12,023 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:12,023 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:12,023 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:12,023 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:12,023 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:12,023 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:12,023 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:12,023 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:12,024 - training.grpo_trainer - INFO - 🔄 GRPO update completed: loss=-0.0098, reward=0.7141
2025-06-23 18:40:12,024 - integration.main_trainer - INFO - 📊 Iteration 12 metrics:
2025-06-23 18:40:12,024 - integration.main_trainer - INFO -   - Policy Loss: 0.000000
2025-06-23 18:40:12,024 - integration.main_trainer - INFO -   - KL Divergence: 0.018731
2025-06-23 18:40:12,024 - integration.main_trainer - INFO -   - Entropy: 1.000000
2025-06-23 18:40:12,024 - integration.main_trainer - INFO -   - Average Reward: 0.7141
2025-06-23 18:40:12,024 - integration.main_trainer - INFO -   - Iteration Time: 0.20s
2025-06-23 18:40:12,024 - integration.main_trainer - INFO - 🔍 Running validation at iteration 12
2025-06-23 18:40:12,024 - evaluation.validator - INFO - 🔍 Evaluating batch of 2 items
2025-06-23 18:40:12,024 - evaluation.validator - INFO - 📁 Saving validation images to: vlm_grpo_results/validation_images_iter_12
2025-06-23 18:40:12,040 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:12,041 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:12,057 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:12,057 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:12,260 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:12,260 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:12,275 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:12,276 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:12,467 - evaluation.validator - INFO - ✅ Evaluation completed: 0.00% success rate
2025-06-23 18:40:12,467 - evaluation.validator - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:12,467 - integration.main_trainer - INFO - 📊 Validation Results (Iteration 12):
2025-06-23 18:40:12,467 - integration.main_trainer - INFO -   - timestamp: 1750671612.0248
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -   - iteration: 12.0000
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -   - total_samples: 2.0000
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -   - success_rate: 0.0000
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -   - avg_clip_score: 0.0000
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -   - quality_score: 0.0000
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -   - processing_time: 0.4427
2025-06-23 18:40:12,468 - integration.main_trainer - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -   📸 Image 1:
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -     Original: 'dog...'
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -     Enhanced: 'dog, loyal, friendly, artistic, high quality, awar...'
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_12/000_dog_enhanced.png
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_12/000_dog_original.png
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_12/000_dog_prompts.txt
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -     CLIP Score: 0.109
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -   📸 Image 2:
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -     Original: 'city skyline...'
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -     Enhanced: 'city skyline, urban, modern, high quality, 8k reso...'
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_12/001_city skyline_enhanced.png
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_12/001_city skyline_original.png
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_12/001_city skyline_prompts.txt
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -     CLIP Score: 0.118
2025-06-23 18:40:12,468 - integration.main_trainer - INFO -
2025-06-23 18:40:12,540 - integration.main_trainer - INFO - 📈 Uploaded 2 images to wandb
2025-06-23 18:40:12,540 - training.grpo_trainer - INFO - 💾 Checkpoint saved: vlm_grpo_results/best_model.pt
2025-06-23 18:40:12,540 - integration.main_trainer - INFO - 🏆 Best model saved: vlm_grpo_results/best_model.pt
2025-06-23 18:40:12,540 - integration.main_trainer - INFO - 🔄 Iteration 13/50
2025-06-23 18:40:12,556 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:12,557 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:12,604 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:12,604 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:12,705 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:12,706 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:12,752 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:12,753 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:12,784 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:12,785 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:12,785 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:12,785 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:12,785 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:12,785 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:12,785 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:12,785 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:12,786 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:12,786 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:12,786 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:12,786 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:12,786 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:12,786 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:12,786 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:12,786 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:12,787 - training.grpo_trainer - INFO - 🔄 GRPO update completed: loss=-0.0098, reward=0.7020
2025-06-23 18:40:12,787 - integration.main_trainer - INFO - 📊 Iteration 13 metrics:
2025-06-23 18:40:12,787 - integration.main_trainer - INFO -   - Policy Loss: 0.000000
2025-06-23 18:40:12,787 - integration.main_trainer - INFO -   - KL Divergence: 0.018731
2025-06-23 18:40:12,787 - integration.main_trainer - INFO -   - Entropy: 1.000000
2025-06-23 18:40:12,787 - integration.main_trainer - INFO -   - Average Reward: 0.7020
2025-06-23 18:40:12,787 - integration.main_trainer - INFO -   - Iteration Time: 0.25s
2025-06-23 18:40:12,787 - integration.main_trainer - INFO - 🔍 Running validation at iteration 13
2025-06-23 18:40:12,787 - evaluation.validator - INFO - 🔍 Evaluating batch of 2 items
2025-06-23 18:40:12,787 - evaluation.validator - INFO - 📁 Saving validation images to: vlm_grpo_results/validation_images_iter_13
2025-06-23 18:40:12,803 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:12,804 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:12,819 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:12,820 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:13,023 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:13,024 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:13,040 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:13,041 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:13,228 - evaluation.validator - INFO - ✅ Evaluation completed: 0.00% success rate
2025-06-23 18:40:13,229 - evaluation.validator - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:13,229 - integration.main_trainer - INFO - 📊 Validation Results (Iteration 13):
2025-06-23 18:40:13,229 - integration.main_trainer - INFO -   - timestamp: 1750671612.7877
2025-06-23 18:40:13,229 - integration.main_trainer - INFO -   - iteration: 13.0000
2025-06-23 18:40:13,229 - integration.main_trainer - INFO -   - total_samples: 2.0000
2025-06-23 18:40:13,229 - integration.main_trainer - INFO -   - success_rate: 0.0000
2025-06-23 18:40:13,229 - integration.main_trainer - INFO -   - avg_clip_score: 0.0000
2025-06-23 18:40:13,229 - integration.main_trainer - INFO -   - quality_score: 0.0000
2025-06-23 18:40:13,229 - integration.main_trainer - INFO -   - processing_time: 0.4413
2025-06-23 18:40:13,229 - integration.main_trainer - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:13,229 - integration.main_trainer - INFO -   📸 Image 1:
2025-06-23 18:40:13,229 - integration.main_trainer - INFO -     Original: 'dog...'
2025-06-23 18:40:13,229 - integration.main_trainer - INFO -     Enhanced: 'dog, loyal, friendly, professional, masterpiece, d...'
2025-06-23 18:40:13,230 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_13/000_dog_enhanced.png
2025-06-23 18:40:13,230 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_13/000_dog_original.png
2025-06-23 18:40:13,230 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_13/000_dog_prompts.txt
2025-06-23 18:40:13,230 - integration.main_trainer - INFO -     CLIP Score: 0.104
2025-06-23 18:40:13,230 - integration.main_trainer - INFO -
2025-06-23 18:40:13,230 - integration.main_trainer - INFO -   📸 Image 2:
2025-06-23 18:40:13,230 - integration.main_trainer - INFO -     Original: 'city skyline...'
2025-06-23 18:40:13,230 - integration.main_trainer - INFO -     Enhanced: 'city skyline, urban, modern, masterpiece, high qua...'
2025-06-23 18:40:13,230 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_13/001_city skyline_enhanced.png
2025-06-23 18:40:13,230 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_13/001_city skyline_original.png
2025-06-23 18:40:13,230 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_13/001_city skyline_prompts.txt
2025-06-23 18:40:13,230 - integration.main_trainer - INFO -     CLIP Score: 0.112
2025-06-23 18:40:13,230 - integration.main_trainer - INFO -
2025-06-23 18:40:13,301 - integration.main_trainer - INFO - 📈 Uploaded 2 images to wandb
2025-06-23 18:40:13,301 - integration.main_trainer - INFO - 🔄 Iteration 14/50
2025-06-23 18:40:13,317 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:13,317 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:13,365 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:13,365 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:13,412 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:13,413 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:13,459 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:13,460 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:13,490 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:13,490 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:13,491 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:13,491 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:13,491 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:13,491 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:13,491 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:13,491 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:13,491 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:13,492 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:13,492 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:13,492 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:13,492 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:13,492 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:13,492 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:13,492 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:13,492 - training.grpo_trainer - INFO - 🔄 GRPO update completed: loss=-0.0098, reward=0.7131
2025-06-23 18:40:13,492 - integration.main_trainer - INFO - 📊 Iteration 14 metrics:
2025-06-23 18:40:13,492 - integration.main_trainer - INFO -   - Policy Loss: 0.000000
2025-06-23 18:40:13,492 - integration.main_trainer - INFO -   - KL Divergence: 0.018731
2025-06-23 18:40:13,492 - integration.main_trainer - INFO -   - Entropy: 1.000000
2025-06-23 18:40:13,492 - integration.main_trainer - INFO -   - Average Reward: 0.7131
2025-06-23 18:40:13,492 - integration.main_trainer - INFO -   - Iteration Time: 0.19s
2025-06-23 18:40:13,493 - integration.main_trainer - INFO - 🔍 Running validation at iteration 14
2025-06-23 18:40:13,493 - evaluation.validator - INFO - 🔍 Evaluating batch of 2 items
2025-06-23 18:40:13,493 - evaluation.validator - INFO - 📁 Saving validation images to: vlm_grpo_results/validation_images_iter_14
2025-06-23 18:40:13,509 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:13,509 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:13,525 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:13,525 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:13,730 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:13,730 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:13,747 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:13,747 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:13,931 - evaluation.validator - INFO - ✅ Evaluation completed: 0.00% success rate
2025-06-23 18:40:13,931 - evaluation.validator - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:13,932 - integration.main_trainer - INFO - 📊 Validation Results (Iteration 14):
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -   - timestamp: 1750671613.4932
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -   - iteration: 14.0000
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -   - total_samples: 2.0000
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -   - success_rate: 0.0000
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -   - avg_clip_score: 0.0000
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -   - quality_score: 0.0000
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -   - processing_time: 0.4385
2025-06-23 18:40:13,932 - integration.main_trainer - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -   📸 Image 1:
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -     Original: 'dog...'
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -     Enhanced: 'dog, loyal, friendly, professional, well-lit, vivi...'
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_14/000_dog_enhanced.png
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_14/000_dog_original.png
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_14/000_dog_prompts.txt
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -     CLIP Score: 0.118
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -   📸 Image 2:
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -     Original: 'city skyline...'
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -     Enhanced: 'city skyline, urban, modern, high quality, profess...'
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_14/001_city skyline_enhanced.png
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_14/001_city skyline_original.png
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_14/001_city skyline_prompts.txt
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -     CLIP Score: 0.121
2025-06-23 18:40:13,932 - integration.main_trainer - INFO -
2025-06-23 18:40:14,002 - integration.main_trainer - INFO - 📈 Uploaded 2 images to wandb
2025-06-23 18:40:14,002 - integration.main_trainer - INFO - 🔄 Iteration 15/50
2025-06-23 18:40:14,018 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:14,018 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:14,066 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:14,066 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:14,165 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:14,166 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:14,213 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:14,213 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:14,243 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:14,244 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:14,244 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:14,244 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:14,244 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:14,244 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:14,244 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:14,244 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:14,245 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:14,245 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:14,245 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:14,245 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:14,245 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:14,245 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:14,245 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:14,245 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:14,246 - training.grpo_trainer - INFO - 🔄 GRPO update completed: loss=-0.0098, reward=0.7051
2025-06-23 18:40:14,246 - integration.main_trainer - INFO - 📊 Iteration 15 metrics:
2025-06-23 18:40:14,246 - integration.main_trainer - INFO -   - Policy Loss: 0.000000
2025-06-23 18:40:14,246 - integration.main_trainer - INFO -   - KL Divergence: 0.018731
2025-06-23 18:40:14,246 - integration.main_trainer - INFO -   - Entropy: 1.000000
2025-06-23 18:40:14,246 - integration.main_trainer - INFO -   - Average Reward: 0.7051
2025-06-23 18:40:14,246 - integration.main_trainer - INFO -   - Iteration Time: 0.24s
2025-06-23 18:40:14,246 - integration.main_trainer - INFO - 🔍 Running validation at iteration 15
2025-06-23 18:40:14,246 - evaluation.validator - INFO - 🔍 Evaluating batch of 2 items
2025-06-23 18:40:14,246 - evaluation.validator - INFO - 📁 Saving validation images to: vlm_grpo_results/validation_images_iter_15
2025-06-23 18:40:14,262 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:14,263 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:14,279 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:14,280 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:14,481 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:14,481 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:14,498 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:14,498 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:14,682 - evaluation.validator - INFO - ✅ Evaluation completed: 0.00% success rate
2025-06-23 18:40:14,682 - evaluation.validator - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:14,682 - integration.main_trainer - INFO - 📊 Validation Results (Iteration 15):
2025-06-23 18:40:14,682 - integration.main_trainer - INFO -   - timestamp: 1750671614.2470
2025-06-23 18:40:14,682 - integration.main_trainer - INFO -   - iteration: 15.0000
2025-06-23 18:40:14,682 - integration.main_trainer - INFO -   - total_samples: 2.0000
2025-06-23 18:40:14,682 - integration.main_trainer - INFO -   - success_rate: 0.0000
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -   - avg_clip_score: 0.0000
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -   - quality_score: 0.0000
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -   - processing_time: 0.4354
2025-06-23 18:40:14,683 - integration.main_trainer - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -   📸 Image 1:
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -     Original: 'dog...'
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -     Enhanced: 'dog, loyal, friendly, 8k resolution, sharp focus, ...'
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_15/000_dog_enhanced.png
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_15/000_dog_original.png
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_15/000_dog_prompts.txt
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -     CLIP Score: 0.115
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -   📸 Image 2:
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -     Original: 'city skyline...'
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -     Enhanced: 'city skyline, urban, modern, well-lit, high qualit...'
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_15/001_city skyline_enhanced.png
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_15/001_city skyline_original.png
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_15/001_city skyline_prompts.txt
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -     CLIP Score: 0.113
2025-06-23 18:40:14,683 - integration.main_trainer - INFO -
2025-06-23 18:40:14,753 - integration.main_trainer - INFO - 📈 Uploaded 2 images to wandb
2025-06-23 18:40:14,753 - integration.main_trainer - INFO - 🔄 Iteration 16/50
2025-06-23 18:40:14,769 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:14,770 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:14,816 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:14,817 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:14,862 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:14,863 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:14,910 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:14,911 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:14,940 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:14,940 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:14,940 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:14,940 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:14,940 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:14,940 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:14,940 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:14,940 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:14,941 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:14,941 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:14,941 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:14,941 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:14,941 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:14,941 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:14,941 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:14,941 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:14,942 - training.grpo_trainer - INFO - 🔄 GRPO update completed: loss=-0.0098, reward=0.7025
2025-06-23 18:40:14,942 - integration.main_trainer - INFO - 📊 Iteration 16 metrics:
2025-06-23 18:40:14,942 - integration.main_trainer - INFO -   - Policy Loss: 0.000000
2025-06-23 18:40:14,942 - integration.main_trainer - INFO -   - KL Divergence: 0.018731
2025-06-23 18:40:14,942 - integration.main_trainer - INFO -   - Entropy: 1.000000
2025-06-23 18:40:14,942 - integration.main_trainer - INFO -   - Average Reward: 0.7025
2025-06-23 18:40:14,942 - integration.main_trainer - INFO -   - Iteration Time: 0.19s
2025-06-23 18:40:14,942 - integration.main_trainer - INFO - 🔍 Running validation at iteration 16
2025-06-23 18:40:14,942 - evaluation.validator - INFO - 🔍 Evaluating batch of 2 items
2025-06-23 18:40:14,942 - evaluation.validator - INFO - 📁 Saving validation images to: vlm_grpo_results/validation_images_iter_16
2025-06-23 18:40:14,959 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:14,959 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:14,975 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:14,976 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:15,177 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:15,177 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:15,194 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:15,194 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:15,379 - evaluation.validator - INFO - ✅ Evaluation completed: 0.00% success rate
2025-06-23 18:40:15,379 - evaluation.validator - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:15,379 - integration.main_trainer - INFO - 📊 Validation Results (Iteration 16):
2025-06-23 18:40:15,379 - integration.main_trainer - INFO -   - timestamp: 1750671614.9429
2025-06-23 18:40:15,379 - integration.main_trainer - INFO -   - iteration: 16.0000
2025-06-23 18:40:15,379 - integration.main_trainer - INFO -   - total_samples: 2.0000
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -   - success_rate: 0.0000
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -   - avg_clip_score: 0.0000
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -   - quality_score: 0.0000
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -   - processing_time: 0.4366
2025-06-23 18:40:15,380 - integration.main_trainer - INFO - 💾 Saved 2 validation images
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -   📸 Image 1:
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -     Original: 'dog...'
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -     Enhanced: 'dog, loyal, friendly, masterpiece, artistic, cinem...'
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_16/000_dog_enhanced.png
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_16/000_dog_original.png
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_16/000_dog_prompts.txt
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -     CLIP Score: 0.106
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -   📸 Image 2:
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -     Original: 'city skyline...'
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -     Enhanced: 'city skyline, urban, modern, sharp focus, well-lit...'
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -     Enhanced Path: vlm_grpo_results/validation_images_iter_16/001_city skyline_enhanced.png
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -     Original Path: vlm_grpo_results/validation_images_iter_16/001_city skyline_original.png
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -     Prompts File: vlm_grpo_results/validation_images_iter_16/001_city skyline_prompts.txt
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -     CLIP Score: 0.120
2025-06-23 18:40:15,380 - integration.main_trainer - INFO -
2025-06-23 18:40:15,451 - integration.main_trainer - INFO - 📈 Uploaded 2 images to wandb
2025-06-23 18:40:15,451 - integration.main_trainer - INFO - 🔄 Iteration 17/50
2025-06-23 18:40:15,467 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:15,468 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:15,515 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:15,516 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:15,562 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:15,563 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:15,608 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:15,608 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:15,638 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:15,638 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:15,639 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:15,639 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:15,639 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:15,639 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:15,639 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:15,639 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:15,639 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 0
2025-06-23 18:40:15,639 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 0
2025-06-23 18:40:15,640 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 1
2025-06-23 18:40:15,640 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 1
2025-06-23 18:40:15,640 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 2
2025-06-23 18:40:15,640 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 2
2025-06-23 18:40:15,640 - training.grpo_trainer - WARNING - ⚠️ Missing ref_log_probs for sample 3
2025-06-23 18:40:15,640 - training.grpo_trainer - WARNING - ⚠️ Missing advantages for sample 3
2025-06-23 18:40:15,640 - training.grpo_trainer - INFO - 🔄 GRPO update completed: loss=-0.0098, reward=0.7019
2025-06-23 18:40:15,640 - integration.main_trainer - INFO - 📊 Iteration 17 metrics:
2025-06-23 18:40:15,640 - integration.main_trainer - INFO -   - Policy Loss: 0.000000
2025-06-23 18:40:15,640 - integration.main_trainer - INFO -   - KL Divergence: 0.018731
2025-06-23 18:40:15,640 - integration.main_trainer - INFO -   - Entropy: 1.000000
2025-06-23 18:40:15,640 - integration.main_trainer - INFO -   - Average Reward: 0.7019
2025-06-23 18:40:15,640 - integration.main_trainer - INFO -   - Iteration Time: 0.19s
2025-06-23 18:40:15,640 - integration.main_trainer - INFO - 🔍 Running validation at iteration 17
2025-06-23 18:40:15,640 - evaluation.validator - INFO - 🔍 Evaluating batch of 2 items
2025-06-23 18:40:15,641 - evaluation.validator - INFO - 📁 Saving validation images to: vlm_grpo_results/validation_images_iter_17
2025-06-23 18:40:15,657 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:15,658 - models.sd_generator - INFO - 🔄 Using fallback image
2025-06-23 18:40:15,673 - models.sd_generator - ERROR - ❌ Image generation failed: Torch not compiled with CUDA enabled
2025-06-23 18:40:15,674 - models.sd_generator - INFO - 🔄 Using fallback image
